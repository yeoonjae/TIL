# **μ „λµ ν¨ν„΄**

<a href = "https://github.com/yeoonjae/TIL/blob/main/Spring/ν…ν”λ¦Ώ_λ©”μ†λ“_ν¨ν„΄.md">ν…ν”λ¦Ώ λ©”μ†λ“ ν¨ν„΄</a>μ—μ„ ν•µμ‹¬κΈ°λ¥κ³Ό λ¶€κ°€κΈ°λ¥μ„ κµ¬λ¶„ν•κΈ° μ„ν•΄μ„  μƒμ†μ λ‹¨μ μ„ κ·Έλ€λ΅ μ•κ³ κ°€μ•Ό ν–μµλ‹λ‹¤. μ΄λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄μ„ λ‚μ¨ κ²ƒμ΄ μ „λµ ν¨ν„΄μ…λ‹λ‹¤. μ „λµν¨ν„΄μ— λ€ν•΄μ„ μ•μ•„λ³΄λ„λ΅ ν•κ² μµλ‹λ‹¤. 

## **μ „λµ ν¨ν„΄**

![image](https://user-images.githubusercontent.com/63777714/150561539-fa1be6ad-7cdb-410c-b8f8-081a841f22fe.png)
 
μ „λµν¨ν„΄μ€ λ³€ν•μ§€ μ•λ” λ¶€λ¶„μ„ `Context(λ¬Έλ§¥)` λΌλ” κ³³μ— λ‘κ³ , λ³€ν•λ” λ¶€λ¶„μ„ `Strategy`λΌλ” μΈν„°νμ΄μ¤λ¥Ό λ§λ“¤μ–΄ ν•΄λ‹Ή μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ„λ΅ ν•λ” ν¨ν„΄μ„ λ§ν•©λ‹λ‹¤. μ΄μ „μ— ν…ν”λ¦Ώ λ©”μ†λ“ ν¨ν„΄μ—μ„ λ°μƒν–λ μƒμ†μ λ‹¨μ μ΄ μ κ±°λ ν¨ν„΄μ…λ‹λ‹¤. 

μ½”λ“λ¥Ό ν†µν•΄μ„ μ‚΄ν΄λ³΄κ² μµλ‹λ‹¤. 
```java
/*
 * ν•„λ“μ— μ „λµμ„ λ³΄κ΄€ν•λ” λ°©μ‹
 */
@Slf4j
public class ContextV1 {

  private Strategy strategy;

  public ContextV1(Strategy strategy) {
    this.strategy = strategy;
  }

  public void execute() {
    long startTime = System.currentTimeMillis();
    // λΉ„μ¦λ‹μ¤ λ΅μ§ μ‹¤ν–‰
    strategy.call();
    // λΉ„μ¦λ‹μ¤ λ΅μ§ μΆ…λ£
    long endTime = System.currentTimeMillis();
    long resultTime = endTime - startTime;
    log.info("resultTime={}", resultTime);
  }
}

```
```java
public interface Strategy {
  void call();
}
```
```java
@Slf4j
public class StratefyLogic1 implements Strategy{

  @Override
  public void call() {
    log.info("λΉ„μ¦λ‹μ¤ λ΅μ§1 μ‹¤ν–‰");
  }
}
```
```java
@Slf4j
public class StratefyLogic2 implements Strategy{

  @Override
  public void call() {
    log.info("λΉ„μ¦λ‹μ¤ λ΅μ§2 μ‹¤ν–‰");
  }
}
```
μ„μ `ContextV1`μ€ λ³€ν•μ§€ μ•λ” λ΅μ§μ„ κ°€μ§€λ” ν…ν”λ¦Ώ μ—­ν• μ„ ν•©λ‹λ‹¤. μ „λµν¨ν„΄μ—μ„λ” `Context(λ¬Έλ§¥)`μ΄ λ©λ‹λ‹¤. κ·Έλ¦¬κ³  `Context` λ‚΄λ¶€μ—λ” λ³€ν•λ” λ¶€λ¶„μ„ μΈν„°νμ΄μ¤λ΅ κµ¬ν„ν• `Strategy`λ¥Ό ν•„λ“λ΅ κ°€μ§€κ³  μμµλ‹λ‹¤. 

μ „λµν¨ν„΄μ ν•µμ‹¬μ€ `Context`λ” `Strategy` μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ‹¤λ” μ μ…λ‹λ‹¤. μ΄ λ•λ¶„μ— `Strategy`μ κµ¬ν„μ²΄λ¥Ό λ³€κ²½ν•κ±°λ‚ μƒλ΅ λ§λ“¤μ–΄λ„ `Context`λ” μν–¥μ„ λ°›μ§€ μ•μµλ‹λ‹¤. 

μ‹¤ν–‰μ½”λ“
```java
  /*
  * μ „λµ ν¨ν„΄ μ‚¬μ©
  * */
  @Test
  void strategyV1() {
    StrategyLogic1 strategyLogic1 = new StrategyLogic1();
    ContextV1 comtextV1 = new ContextV1(strategyLogic1);
    comtextV1.execute();

    StrategyLogic2 strategyLogic2 = new StrategyLogic2();
    ContextV1 comtextV2 = new ContextV1(strategyLogic2);
    comtextV2.execute();
  }
```
κ²°κ³Ό

![image](https://user-images.githubusercontent.com/63777714/150564306-eef238ed-5187-4044-bd05-d969ec9331b7.png)


![image](https://user-images.githubusercontent.com/63777714/150564387-962a557a-192f-4fae-9906-f523419ebbe8.png)
1. `Context` μ— μ›ν•λ” `Strategy` κµ¬ν„μ²΄λ¥Ό μ£Όμ…ν•λ‹¤.
2. ν΄λΌμ΄μ–ΈνΈλ” `context` λ¥Ό μ‹¤ν–‰ν•λ‹¤.
3. `context` λ” `context` λ΅μ§μ„ μ‹μ‘ν•λ‹¤.
4. `context` λ΅μ§ μ¤‘κ°„μ— `strategy.call()` μ„ νΈμ¶ν•΄μ„ μ£Όμ… λ°›μ€ `strategy` λ΅μ§μ„ μ‹¤ν–‰ν•λ‹¤.

---
## **μµλ… λ‚΄λ¶€ ν΄λμ¤ μ‚¬μ©ν•κΈ°**

ν•λ‚μ”© ν΄λμ¤λ¥Ό κµ¬ν„ν•΄μ¤„ ν•„μ”μ—†μ΄ μµλ… λ‚΄λ¶€ ν΄λμ¤λ¥Ό μ‚¬μ©ν•λ” λ°©λ²•λ„ μλ‹¤. 

μ‹¤ν–‰μ½”λ“
```java  
@Test
void strategyV2() {
Strategy strategyLogic1 = new Strategy() {
    @Override
    public void call() {
    log.info("λΉ„μ¦λ‹μ¤ λ΅μ§1 μ‹¤ν–‰");
    }
};
ContextV1 context1 = new ContextV1(strategyLogic1);
context1.execute();

Strategy strategyLogic2 = new Strategy() {
    @Override
    public void call() {
    log.info("λΉ„μ¦λ‹μ¤ λ΅μ§1 μ‹¤ν–‰");
    }
};
ContextV1 context2 = new ContextV1(strategyLogic2);
context2.execute();
}
```
κ²°κ³Ό
![image](https://user-images.githubusercontent.com/63777714/150566032-baaf792b-36d8-4f72-b750-1ca6b3b32a47.png)

μµλ… λ‚΄λ¶€ ν΄λμ¤λ¥Ό μ‚¬μ©ν•΄λ„ λ™μΌν• κ²°κ³Όκ°€ λ‚μ¤λ” κ²ƒμ„ λ³Ό μ μμµλ‹λ‹¤. 

μ΅°κΈ λ” μ½”λ“λ¥Ό κΉ”λ”ν•κ² λ‹¤μκ³Ό κ°™μ΄ μ½”λ“λ¥Ό μ‘μ„±ν•  μλ„ μμµλ‹λ‹¤.
```java
@Test
void strategyV3() {
ContextV1 context1 = new ContextV1(new Strategy() {
    @Override
    public void call() {
    log.info("λΉ„μ¦λ‹μ¤ λ΅μ§1 μ‹¤ν–‰");
    }
});
context1.execute();

ContextV1 context2 = new ContextV1(new Strategy() {
    @Override
    public void call() {
    log.info("λΉ„μ¦λ‹μ¤ λ΅μ§2 μ‹¤ν–‰");
    }
});
context2.execute();
}
```

κ·Έλ¦¬κ³  λλ‹¤λ¥Ό μ‚¬μ©ν•  μλ„ μμµλ‹λ‹¤. π‘π‘
> λλ‹¤λ΅ λ³€κ²½ν•λ ¤λ©΄ μΈν„°νμ΄μ¤μ— λ©”μ†λ“κ°€ 1κ°λ§ μ΅΄μ¬ν•λ©΄ λ³€κ²½ν•  μ μλ‹¤. 
```java
@Test
void strategyV4() {

    ContextV1 context1 = new ContextV1(() -> log.info("λΉ„μ¦λ‹μ¤ λ΅μ§1 μ‹¤ν–‰"));
    context1.execute();

    ContextV1 context2 = new ContextV1(() -> log.info("λΉ„μ¦λ‹μ¤ λ΅μ§2 μ‹¤ν–‰"));
    context2.execute();
}
```

---
## **μ„  μ΅°λ¦½, ν›„ μ‹¤ν–‰**
μ΄ λ°©μ‹μ€ `Context`μ™€ `Strategy`λ¥Ό μ‹¤ν–‰ μ „μ— μ›ν•λ” λ¨μ–‘μΌλ΅ μ΅°λ¦½ν•΄λ‘κ³ , κ·Έ λ‹¤μμ— Context λ¥Ό μ‹¤ν–‰ν•λ” `μ„  μ΅°λ¦½, ν›„ μ‹¤ν–‰` λ°©μ‹μ—μ„ λ§¤μ° μ μ©ν•©λ‹λ‹¤.

`Context`μ™€ `Strategy`λ¥Ό ν• λ² μ΅°λ¦½ν•κ³  λ‚λ©΄ μ΄ν›„λ΅λ” Context λ¥Ό μ‹¤ν–‰ν•κΈ°λ§ ν•λ©΄ λ©λ‹λ‹¤. μ°λ¦¬κ°€ μ¤ν”„λ§μΌλ΅ μ• ν”λ¦¬μΌ€μ΄μ…μ„ κ°λ°ν•  λ• μ• ν”λ¦¬μΌ€μ΄μ… λ΅λ”© μ‹μ μ— μμ΅΄κ΄€κ³„ μ£Όμ…μ„ ν†µν•΄ ν•„μ”ν• μμ΅΄κ΄€κ³„λ¥Ό λ¨λ‘ λ§Ίμ–΄λ‘κ³  λ‚ λ‹¤μμ— μ‹¤μ  μ”μ²­μ„ μ²λ¦¬ν•λ” κ²ƒ κ³Ό κ°™μ€ μ›λ¦¬μ…λ‹λ‹¤.

λ‹¨μ μ€ `Context`μ™€ `Strategy`λ¥Ό μ΅°λ¦½ν• μ΄ν›„μ—λ” μ „λµμ„ λ³€κ²½ν•κΈ°κ°€ λ²κ±°λ΅­λ‹¤λ” μ μ…λ‹λ‹¤. 
`Context`μ— setter λ¥Ό μ κ³µν•΄μ„ Strategy λ¥Ό λ„κ²¨ λ°›μ•„ λ³€κ²½ν•λ©΄ λμ§€λ§, Context λ¥Ό **μ‹±κΈ€ν†¤μΌλ΅ μ‚¬μ©ν•  λ•λ” λ™μ‹μ„± μ΄μ λ“± κ³ λ ¤ν•  μ μ΄ λ§μ•„**μ§‘λ‹λ‹¤. 

κ·Έλμ„ μ „λµμ„ μ‹¤μ‹κ°„μΌλ΅ λ³€κ²½ν•΄μ•Ό ν•λ©΄ μ΄μ „μ— κ°λ°ν• ν…μ¤νΈ μ½”λ“ μ²λΌ Contextλ¥Ό ν•λ‚ λ” μƒμ„±ν•κ³  κ·Έκ³³μ— λ‹¤λ¥Έ Strategy λ¥Ό μ£Όμ…ν•λ” κ²ƒμ΄ μΆ‹μ€ μ„ νƒμ§€κ°€ λ  μλ„ μμµλ‹λ‹¤. 

---
## **νλΌλ―Έν„°λ¥Ό μ΄μ©ν• μ „λµ ν¨ν„΄**
μ „λµμ„ ν•„λ“μ—μ„ κ°–μ§€ μ•κ³  νλΌλ―Έν„°λ΅ μ „λ‹¬ λ°›λ” λ°©λ²•μ„ μ•μ•„λ³΄κ² μµλ‹λ‹¤. 

![image](https://user-images.githubusercontent.com/63777714/150568525-e6f0fcf5-f36a-4936-a1db-71450812abeb.png)

```java
/**
   * μ „λµ ν¨ν„΄ μ μ©
   * */
  @Test
  void strategyV1() {
    ContextV2 context = new ContextV2();
    context.execute(new StrategyLogic1());
    context.execute(new StrategyLogic2());
  }
```
Contextμ™€ Strategyλ¥Ό `μ„ μ΅°λ¦½,ν›„μ‹¤ν–‰` λ°©μ‹μ΄ μ•„λ‹ Contextλ¥Ό μ‹¤ν–‰ν•  λ•λ§λ‹¤ μ „λµμ„ μΈμλ΅ μ „λ‹¬ν•μ—¬ Contextλ¥Ό μ‹¤ν–‰ν•λ” μ‹μ μ— Strategyλ¥Ό μ „λ‹¬ν•  μ μλ„λ΅ μ΄μ „ λ°©μ‹κ³Ό λ‹¤λ¥΄κ² μ‚¬μ©ν•  μλ„ μμµλ‹λ‹¤. 

μ„μ μ½”λ“μ²λΌ μ‹¤ν–‰μ‹μ μ— μ μ—°ν•κ² μ›ν•λ” μ „λµμ„ μƒμ„±ν•΄μ„ λμ§ μ μμµλ‹λ‹¤. 

---
## **μ •λ¦¬**
μ²μ κµ¬ν„ν–λ ContextV1μ€ `μ„ μ΅°λ¦½, ν›„μ‹¤ν–‰` λ°©μ‹μΌλ΅ ν•„λ“μ— `Strategy`λ¥Ό μ„ μ–Έν•λ” λ°©μ‹μΌλ΅ κµ¬ν„ν–μµλ‹λ‹¤. μ΄λ” Contextλ¥Ό μ‹¤ν–‰ν•λ” μ‹μ μ— μ΄λ―Έ μ΅°λ¦½μ΄ μ™„λ£λ μƒνƒλΌ μ „λµμ„ μ‹ κ²½μ“°μ§€ μ•κ³  μ‹¤ν–‰μ—λ§ μ§‘μ¤‘ν•  μ μμ§€λ§, μ „λµμ„ λ³€κ²½ν•κΈ°μ—” μ ν•©ν• λ°©μ‹μ΄ μ•„λ‹™λ‹λ‹¤. 

ContextV2λ” νλΌλ―Έν„°μ— `Strategy`λ¥Ό μ „λ‹¬λ°›λ” λ°©μ‹μΌλ΅ μ „λµν¨ν„΄μ„ κµ¬ν„ν–μµλ‹λ‹¤. μ‹¤ν–‰μ‹λ§λ‹¤ μ „λµμ„ μ μ—°ν•κ² λ³€κ²½ν•  μ μλ‹¤λ” μ¥μ κ³Ό λ‹¨μ μ„ κ°–κ³  μμµλ‹λ‹¤. 

> π” **μ „λµ ν¨ν„΄μ΄λ€ λ¬΄μ—‡μΈκ°€μ”?** <br>
> μ „λµμ„ μƒμ„±ν•΄ μ „λµμ„ μ‹¤ν–‰ν•  μ»¨ν…μ¤νΈ(λ¬Έλ§¥)μ— μ£Όμ…ν•λ” ν¨ν„΄μ„ λ§ν•©λ‹λ‹¤. 


---
μ°Έκ³ 
- μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬-κ³ κΈ‰νΈ (μΈν”„λ°_κΉ€μν•λ‹)